<!DOCTYPE html>
<html lang="th">
<head>
<body>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>กิจกรรมบริษัท</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        h1, h2 {
            color: #333;
        }
        form {
            margin-top: 20px;
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            padding: 10px 15px;
            background-color: #5cb85c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #4cae4c;
        }
        #output {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .activity {
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            background-color: #f9f9f9;
        }
        #image-preview {
            margin-top: 10px;
        }
        img {
            max-width: 70px;
            margin-right: 5px;
            cursor: pointer; /* เปลี่ยนให้ดูเหมือนคลิกได้ */
        }
        .delete-button {
            background-color: #d9534f;
        }
        .delete-button:hover {
            background-color: #c9302c;
        }
        .activity-info {
            font-size: 0.9em;
        }
        #pagination {
            margin-top: 20px;
        }
        /* Modal styles */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto; 
            background-color: rgba(0,0,0,0.9); 
        }
        .modal-content {
    margin: auto; 
    display: block;
    width: 80%; 
    max-width: 900px; 
    max-height: 80%; 
    height: auto; /* เพิ่มบรรทัดนี้ */
}
        .close {
            position: absolute;
            top: 20px;
            right: 35px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
    
        <div>
        <h2>กรอกข้อมูลกิจกรรม</h2>
            <form id="activityForm">
                <label for="activity-name">เรื่อง:</label>
                <input type="text" id="activity-name" name="activity-name" required>

                <label for="date">วันที่:</label>
                <input type="date" id="date" name="date" required>

                <label for="location">สถานที่:</label>
                <input type="text" id="location" name="location" required>

                <label for="description">รายละเอียด:</label>
                <textarea id="description" name="description" rows="4" required></textarea>

                <label for="images">อัปโหลดรูปภาพ:</label>
                <input type="file" id="images" name="images" multiple accept="image/*" required>
                <div id="image-preview"></div>

                <button type="submit">ส่งข้อมูล</button>
            </form>

            <div id="output"></div>
            <div id="pagination"></div>

            <!-- Modal for displaying the large image -->
            <div id="myModal" class="modal">
                <span class="close" id="closeModal">&times;</span>
                <img class="modal-content" id="modalImage" alt="Large view">
            </div>

            <script>
                let activities = JSON.parse(localStorage.getItem('activities')) || [];
                let currentPage = 1;
                const itemsPerPage = 3;

                document.getElementById('images').addEventListener('change', function(event) {
                    const files = event.target.files;
                    const preview = document.getElementById('image-preview');
                    preview.innerHTML = '';

                    for (const file of files) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.onclick = function() {
                                showModal(e.target.result); // คลิกเพื่อดูรูปใหญ่
                            };
                            preview.appendChild(img);
                        }
                        reader.readAsDataURL(file);
                    }
                });

                document.getElementById('activityForm').addEventListener('submit', function(event) {
                    event.preventDefault();

                    const activityName = document.getElementById('activity-name').value;
                    const date = document.getElementById('date').value;
                    const location = document.getElementById('location').value;
                    const description = document.getElementById('description').value;
                    const imagePreview = document.getElementById('image-preview').innerHTML;

                    activities.unshift({
                        name: activityName,
                        date: date,
                        location: location,
                        description: description,
                        images: imagePreview
                    });

                    localStorage.setItem('activities', JSON.stringify(activities));
                    displayActivities();
                    this.reset();
                    document.getElementById('image-preview').innerHTML = '';
                });

                function displayActivities() {
                    const output = document.getElementById('output');
                    output.innerHTML = '';

                    const start = (currentPage - 1) * itemsPerPage;
                    const end = start + itemsPerPage;
                    const paginatedActivities = activities.slice(start, end);

                    paginatedActivities.forEach((activity, index) => {
                        const activityOutput = `
                            <div class="activity">
                                <div class="activity-info">
                                    <p><strong>เรื่อง:</strong> ${activity.name}</p>
                                    <p><strong>วันที่:</strong> ${activity.date}</p>
                                    <p><strong>สถานที่:</strong> ${activity.location}</p>
                                    <p><strong>รายละเอียด:</strong> ${activity.description}</p>
                                    <p><strong>รูปภาพ:</strong></p>
                                    <div>${activity.images}</div>
                                </div>
                                <button class="delete-button" onclick="deleteActivity(${start + index})">ลบกิจกรรม</button>
                            </div>
                        `;
                        output.innerHTML += activityOutput;
                    });

                    updatePagination();
                }

                function updatePagination() {
                    const pagination = document.getElementById('pagination');
                    pagination.innerHTML = '';

                    const totalPages = Math.ceil(activities.length / itemsPerPage);
                    if (currentPage > 1) {
                        pagination.innerHTML += `<button onclick="changePage(${currentPage - 1})">หน้าก่อน</button>`;
                    }
                    if (currentPage < totalPages) {
                        pagination.innerHTML += `<button onclick="changePage(${currentPage + 1})">หน้าถัดไป</button>`;
                    }
                }

                function changePage(page) {
                    currentPage = page;
                    displayActivities();
                }

                function deleteActivity(index) {
                    activities.splice(index, 1);
                    localStorage.setItem('activities', JSON.stringify(activities));
                    displayActivities();
                }

                // Modal function
                function showModal(imageSrc) {
                    const modal = document.getElementById('myModal');
                    const modalImage = document.getElementById('modalImage');
                    modal.style.display = "block";
                    modalImage.src = imageSrc;
                }

                document.getElementById('closeModal').onclick = function() {
                    document.getElementById('myModal').style.display = "none";
                }

                window.onclick = function(event) {
                    const modal = document.getElementById('myModal');
                    if (event.target == modal) {
                        modal.style.display = "none";
                    }
                }

                displayActivities();
            </script>
        </div>

</body>
</html>
